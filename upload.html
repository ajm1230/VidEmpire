<!DOCTYPE html><html lang="en" class="dark">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Post Manager</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
      tailwind.config = {
        darkMode: 'class',
      }
    </script>
  </head>
  <body class="bg-white dark:bg-gray-900 text-gray-900 dark:text-gray-100 min-h-screen">
    <div class="container mx-auto px-4 py-6">
      <div class="flex justify-between items-center mb-6">
        <h1 class="text-2xl font-bold">Upload Post Manager</h1>
        <button
          onclick="toggleDarkMode()"
          class="px-4 py-2 bg-indigo-600 text-white rounded hover:bg-indigo-700 transition"
        >
          Toggle Dark Mode
        </button>
      </div><div class="flex gap-4 mb-4 flex-wrap">
    <input
      type="text"
      id="searchInput"
      placeholder="Search by title or tag"
      class="w-full sm:w-1/3 px-4 py-2 border border-gray-300 rounded"
      oninput="filterPosts()"
    />
    <select
      id="sortSelect"
      onchange="sortPosts()"
      class="px-4 py-2 border border-gray-300 rounded"
    >
      <option value="latest">Sort by Latest</option>
      <option value="oldest">Sort by Oldest</option>
    </select>
  </div>

  <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6" id="postList"></div>

  <form id="uploadForm" class="mt-10">
    <input type="file" id="fileInput" class="block w-full mb-4" accept="image/*,video/*" required />
    <input type="text" id="titleInput" class="block w-full mb-4 p-2 border" placeholder="Title" required />
    <input type="text" id="tagsInput" class="block w-full mb-4 p-2 border" placeholder="Tags (comma separated)" />
    <button
      type="submit"
      class="bg-green-600 text-white px-6 py-2 rounded hover:bg-green-700 transition"
    >
      Upload
    </button>
    <div id="progressBarContainer" class="w-full bg-gray-200 mt-4 hidden">
      <div
        id="progressBar"
        class="bg-green-500 text-xs font-medium text-white text-center p-0.5 leading-none rounded"
        style="width: 0%"
      >
        0%
      </div>
    </div>
  </form>
</div>

<script>
  let posts = []

  function toggleDarkMode() {
    document.documentElement.classList.toggle('dark')
  }

  document.getElementById('uploadForm').addEventListener('submit', function (e) {
    e.preventDefault()
    const file = document.getElementById('fileInput').files[0]
    const title = document.getElementById('titleInput').value
    const tags = document.getElementById('tagsInput').value.split(',').map(t => t.trim())

    const reader = new FileReader()
    reader.onload = function (event) {
      const post = {
        id: Date.now(),
        title,
        tags,
        file: event.target.result,
        type: file.type.startsWith('video') ? 'video' : 'image',
        timestamp: Date.now(),
      }
      posts.push(post)
      renderPosts()
    }

    document.getElementById('progressBarContainer').classList.remove('hidden')
    const progress = document.getElementById('progressBar')
    let loaded = 0
    const interval = setInterval(() => {
      if (loaded >= 100) {
        clearInterval(interval)
        reader.readAsDataURL(file)
        return
      }
      loaded += 10
      progress.style.width = loaded + '%'
      progress.innerText = loaded + '%'
    }, 100)
  })

  function renderPosts() {
    const postList = document.getElementById('postList')
    postList.innerHTML = ''
    posts.forEach(post => {
      const div = document.createElement('div')
      div.className =
        'bg-white dark:bg-gray-800 shadow-md rounded-xl p-4 transition hover:scale-[1.01] duration-200'

      const media =
        post.type === 'video'
          ? `<video src="${post.file}" controls class="rounded mb-3 w-full"></video>`
          : `<img src="${post.file}" class="rounded mb-3 w-full" />`

      const tags = post.tags
        .map(tag => `<span class="bg-blue-100 text-blue-800 text-xs font-semibold mr-2 px-2.5 py-0.5 rounded">${tag}</span>`) 
        .join(' ')

      div.innerHTML = `
        ${media}
        <h3 class="text-lg font-semibold mb-1">${post.title}</h3>
        <div class="mb-2">${tags}</div>
        <div class="text-sm text-gray-500 dark:text-gray-400">${new Date(post.timestamp).toLocaleString()}</div>
      `
      postList.appendChild(div)
    })
  }

  function filterPosts() {
    const query = document.getElementById('searchInput').value.toLowerCase()
    const filtered = posts.filter(
      p =>
        p.title.toLowerCase().includes(query) ||
        p.tags.some(tag => tag.toLowerCase().includes(query))
    )
    renderFilteredPosts(filtered)
  }

  function sortPosts() {
    const sortValue = document.getElementById('sortSelect').value
    posts.sort((a, b) =>
      sortValue === 'latest' ? b.timestamp - a.timestamp : a.timestamp - b.timestamp
    )
    renderPosts()
  }

  function renderFilteredPosts(filteredPosts) {
    const postList = document.getElementById('postList')
    postList.innerHTML = ''
    filteredPosts.forEach(post => {
      const div = document.createElement('div')
      div.className =
        'bg-white dark:bg-gray-800 shadow-md rounded-xl p-4 transition hover:scale-[1.01] duration-200'

      const media =
        post.type === 'video'
          ? `<video src="${post.file}" controls class="rounded mb-3 w-full"></video>`
          : `<img src="${post.file}" class="rounded mb-3 w-full" />`

      const tags = post.tags
        .map(tag => `<span class="bg-blue-100 text-blue-800 text-xs font-semibold mr-2 px-2.5 py-0.5 rounded">${tag}</span>`) 
        .join(' ')

      div.innerHTML = `
        ${media}
        <h3 class="text-lg font-semibold mb-1">${post.title}</h3>
        <div class="mb-2">${tags}</div>
        <div class="text-sm text-gray-500 dark:text-gray-400">${new Date(post.timestamp).toLocaleString()}</div>
      `
      postList.appendChild(div)
    })
  }
</script>

  </body>
</html>
